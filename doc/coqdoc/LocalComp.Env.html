<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>LocalComp.Env</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">LocalComp.Env</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab3"></a><h1 class="section">Environments</h1>


<div class="paragraph"> </div>

  We have three kinds of environments:
<ul class="doclist">
<li> Σ the global signature, containing definitions and interfaces.

</li>
<li> Ξ the extension environment.

</li>
<li> Γ the local environment.

</li>
</ul>

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Utf8</span> <span class="id" title="library">String</span> <span class="id" title="library">List</span> <span class="id" title="library">Arith</span> <span class="id" title="library">Lia</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">LocalComp.autosubst</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="LocalComp.autosubst.AST.html#"><span class="id" title="library">AST</span></a> <a class="idref" href="LocalComp.autosubst.SubstNotations.html#"><span class="id" title="library">SubstNotations</span></a> <a class="idref" href="LocalComp.autosubst.RAsimpl.html#"><span class="id" title="library">RAsimpl</span></a> <a class="idref" href="LocalComp.autosubst.AST_rasimpl.html#"><span class="id" title="library">AST_rasimpl</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">LocalComp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="LocalComp.Util.html#"><span class="id" title="library">Util</span></a> <a class="idref" href="LocalComp.BasicAST.html#"><span class="id" title="library">BasicAST</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">ListNotations</span>.<br/>

<br/>
</div>

<div class="doc">
Local environment, a list of types 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="ctx" class="idref" href="#ctx"><span class="id" title="definition">ctx</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab4"></a><h2 class="section">Custom computation rule</h2>


<div class="paragraph"> </div>

  We consider them as definitional equalities which might be nonlinear.
  For implementation purposes however, it's better to have a linear version
  (as well as pattern syntax) so we consider the left-hand side as the result of
  applying a "forcing" substitution.

<div class="paragraph"> </div>

  To make the inlining proof easier and more general, we will consider an
  equation proxy where the substitution is already applied.

<div class="paragraph"> </div>

  Fields are
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">cr_env</span></span>: the environment of the rule <span class="inlinecode"><span class="id" title="var">Θ</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">cr_pat</span></span>: the "pattern" for the left-hand side <span class="inlinecode"><span class="id" title="var">p</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">cr_sub</span></span>: the "forcing" substitution <span class="inlinecode">ρ</span> to go from <span class="inlinecode"><span class="id" title="var">p</span></span> to the actual lhs

</li>
<li> <span class="inlinecode"><span class="id" title="var">cr_rep</span></span>: the replacing term <span class="inlinecode"><span class="id" title="var">r</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">cr_typ</span></span>: the type for both sides <span class="inlinecode"><span class="id" title="var">A</span></span>

</li>
</ul>

<div class="paragraph"> </div>

  This represents the following (typed) definitional equality:
  <span class="inlinecode"><span class="id" title="var">Θ</span></span> <span class="inlinecode">⊢</span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">&lt;[ρ]</span> <span class="inlinecode">≡</span> <span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">A</span></span>

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Record</span> <a id="crule" class="idref" href="#crule"><span class="id" title="record">crule</span></a> := {<br/>
&nbsp;&nbsp;<a id="cr_env" class="idref" href="#cr_env"><span class="id" title="projection">cr_env</span></a> : <a class="idref" href="LocalComp.Env.html#ctx"><span class="id" title="definition">ctx</span></a> ;<br/>
&nbsp;&nbsp;<a id="cr_pat" class="idref" href="#cr_pat"><span class="id" title="projection">cr_pat</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> ;<br/>
&nbsp;&nbsp;<a id="cr_sub" class="idref" href="#cr_sub"><span class="id" title="projection">cr_sub</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <span class="id" title="notation">→</span> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> ;<br/>
&nbsp;&nbsp;<a id="cr_rep" class="idref" href="#cr_rep"><span class="id" title="projection">cr_rep</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> ;<br/>
&nbsp;&nbsp;<a id="cr_typ" class="idref" href="#cr_typ"><span class="id" title="projection">cr_typ</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="equation" class="idref" href="#equation"><span class="id" title="record">equation</span></a> := {<br/>
&nbsp;&nbsp;<a id="eq_env" class="idref" href="#eq_env"><span class="id" title="projection">eq_env</span></a> : <a class="idref" href="LocalComp.Env.html#ctx"><span class="id" title="definition">ctx</span></a> ;<br/>
&nbsp;&nbsp;<a id="eq_lhs" class="idref" href="#eq_lhs"><span class="id" title="projection">eq_lhs</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> ;<br/>
&nbsp;&nbsp;<a id="eq_rhs" class="idref" href="#eq_rhs"><span class="id" title="projection">eq_rhs</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> ;<br/>
&nbsp;&nbsp;<a id="eq_typ" class="idref" href="#eq_typ"><span class="id" title="projection">eq_typ</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="crule_eq" class="idref" href="#crule_eq"><span class="id" title="definition">crule_eq</span></a> <a id="rule:12" class="idref" href="#rule:12"><span class="id" title="binder">rule</span></a> : <a class="idref" href="LocalComp.Env.html#equation"><span class="id" title="record">equation</span></a> := {|<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#eq_env"><span class="id" title="projection">eq_env</span></a> := <a class="idref" href="LocalComp.Env.html#rule:12"><span class="id" title="variable">rule</span></a>.(<a class="idref" href="LocalComp.Env.html#cr_env"><span class="id" title="projection">cr_env</span></a>) ;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;eq_lhs&nbsp;:=&nbsp;rule.(cr_pat)&nbsp;&lt;<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">rule</span>.(<span class="id" title="var">cr_sub</span>)</span> <span class="inlinecode"></span>&nbsp;;&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#eq_lhs"><span class="id" title="projection">eq_lhs</span></a> := <a class="idref" href="LocalComp.autosubst.AST.html#Core.subst_term"><span class="id" title="definition">subst_term</span></a> <a class="idref" href="LocalComp.Env.html#rule:12"><span class="id" title="variable">rule</span></a>.(<a class="idref" href="LocalComp.Env.html#cr_sub"><span class="id" title="projection">cr_sub</span></a>) <a class="idref" href="LocalComp.Env.html#rule:12"><span class="id" title="variable">rule</span></a>.(<a class="idref" href="LocalComp.Env.html#cr_pat"><span class="id" title="projection">cr_pat</span></a>) ;<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#eq_rhs"><span class="id" title="projection">eq_rhs</span></a> := <a class="idref" href="LocalComp.Env.html#rule:12"><span class="id" title="variable">rule</span></a>.(<a class="idref" href="LocalComp.Env.html#cr_rep"><span class="id" title="projection">cr_rep</span></a>) ;<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#eq_typ"><span class="id" title="projection">eq_typ</span></a> := <a class="idref" href="LocalComp.Env.html#rule:12"><span class="id" title="variable">rule</span></a>.(<a class="idref" href="LocalComp.Env.html#cr_typ"><span class="id" title="projection">cr_typ</span></a>)<br/>
|}.<br/>

<br/>
</div>

<div class="doc">
Interface declaration

<div class="paragraph"> </div>

  An interface interleaves assumptions (or symbols) and computation rules.

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <a id="idecl" class="idref" href="#idecl"><span class="id" title="definition, inductive"><span id="idecl_rect" class="id"><span id="idecl_ind" class="id"><span id="idecl_rec" class="id"><span id="idecl_sind" class="id">idecl</span></span></span></span></span></a> :=<br/>
| <a id="Assm" class="idref" href="#Assm"><span class="id" title="constructor">Assm</span></a> (<a id="A:15" class="idref" href="#A:15"><span class="id" title="binder">A</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>)<br/>
| <a id="Comp" class="idref" href="#Comp"><span class="id" title="constructor">Comp</span></a> (<a id="rl:16" class="idref" href="#rl:16"><span class="id" title="binder">rl</span></a> : <a class="idref" href="LocalComp.Env.html#crule"><span class="id" title="record">crule</span></a>).<br/>

<br/>
<span class="id" title="keyword">Derive</span> <span class="id" title="var">NoConfusion</span> <span class="id" title="keyword">for</span> <a class="idref" href="LocalComp.Env.html#idecl"><span class="id" title="inductive">idecl</span></a>.<br/>

<br/>
</div>

<div class="doc">
Interface 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="ictx" class="idref" href="#ictx"><span class="id" title="definition">ictx</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="LocalComp.Env.html#idecl"><span class="id" title="inductive">idecl</span></a>.<br/>

<br/>
</div>

<div class="doc">
Instances

<div class="paragraph"> </div>

  It is given by a list of terms corresponding to assumptions of an interface.
  Because an interface also contains rules, we opt for the use of <span class="inlinecode"><span class="id" title="var">None</span></span> in
  the corresponding positions.

<div class="paragraph"> </div>

  Maybe an association list would make more sense.

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="instance" class="idref" href="#instance"><span class="id" title="definition">instance</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>).<br/>

<br/>
</div>

<div class="doc">
Access in an interface

<div class="paragraph"> </div>

  This is special because we use de Bruijn levels so we need to perform some
  simple arithmetic. We also avoid returning <span class="inlinecode"><span class="id" title="var">Some</span></span> for de Bruijn levels that go
  too far.

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="lvl_get" class="idref" href="#lvl_get"><span class="id" title="definition">lvl_get</span></a> [<a id="A:17" class="idref" href="#A:17"><span class="id" title="binder">A</span></a>] (<a id="l:18" class="idref" href="#l:18"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="LocalComp.Env.html#A:17"><span class="id" title="variable">A</span></a>) (<a id="x:19" class="idref" href="#x:19"><span class="id" title="binder">x</span></a> : <a class="idref" href="LocalComp.BasicAST.html#aref"><span class="id" title="definition">aref</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<span class="id" title="definition">rev</span> <a class="idref" href="LocalComp.Env.html#l:18"><span class="id" title="variable">l</span></a>) <a class="idref" href="LocalComp.Env.html#x:19"><span class="id" title="variable">x</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="ictx_get" class="idref" href="#ictx_get"><span class="id" title="abbreviation">ictx_get</span></a> <span class="id" title="var">Ξ</span> <span class="id" title="var">x</span> := (<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<span class="id" title="var">A</span> := <a class="idref" href="LocalComp.Env.html#idecl"><span class="id" title="inductive">idecl</span></a>) <span class="id" title="var">Ξ</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lvl_get_weak" class="idref" href="#lvl_get_weak"><span class="id" title="lemma">lvl_get_weak</span></a> [<a id="A:20" class="idref" href="#A:20"><span class="id" title="binder">A</span></a>] <a id="d:21" class="idref" href="#d:21"><span class="id" title="binder">d</span></a> <a id="l:22" class="idref" href="#l:22"><span class="id" title="binder">l</span></a> <a id="n:23" class="idref" href="#n:23"><span class="id" title="binder">n</span></a> <a id="a:24" class="idref" href="#a:24"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<span class="id" title="var">A</span> := <a class="idref" href="LocalComp.Env.html#A:20"><span class="id" title="variable">A</span></a>) <a class="idref" href="LocalComp.Env.html#l:22"><span class="id" title="variable">l</span></a> <a class="idref" href="LocalComp.Env.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#a:24"><span class="id" title="variable">a</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<a class="idref" href="LocalComp.Env.html#d:21"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="LocalComp.Env.html#l:22"><span class="id" title="variable">l</span></a>) <a class="idref" href="LocalComp.Env.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#a:24"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_app1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_Some</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lvl_get_last" class="idref" href="#lvl_get_last"><span class="id" title="lemma">lvl_get_last</span></a> [<a id="A:25" class="idref" href="#A:25"><span class="id" title="binder">A</span></a>] (<a id="a:26" class="idref" href="#a:26"><span class="id" title="binder">a</span></a> : <a class="idref" href="LocalComp.Env.html#A:25"><span class="id" title="variable">A</span></a>) <a id="l:27" class="idref" href="#l:27"><span class="id" title="binder">l</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<a class="idref" href="LocalComp.Env.html#a:26"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="LocalComp.Env.html#l:27"><span class="id" title="variable">l</span></a>) (<span class="id" title="abbreviation">length</span> <a class="idref" href="LocalComp.Env.html#l:27"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#a:26"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_app2</span>, <span class="id" title="lemma">length_rev</span>, <span class="id" title="lemma">Nat.sub_diag</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">length_rev</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lvl_get_length" class="idref" href="#lvl_get_length"><span class="id" title="lemma">lvl_get_length</span></a> <a id="A:28" class="idref" href="#A:28"><span class="id" title="binder">A</span></a> (<a id="l:29" class="idref" href="#l:29"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="LocalComp.Env.html#A:28"><span class="id" title="variable">A</span></a>) <a id="x:30" class="idref" href="#x:30"><span class="id" title="binder">x</span></a> <a id="a:31" class="idref" href="#a:31"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> <a class="idref" href="LocalComp.Env.html#l:29"><span class="id" title="variable">l</span></a> <a class="idref" href="LocalComp.Env.html#x:30"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#a:31"><span class="id" title="variable">a</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#x:30"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="abbreviation">length</span> <a class="idref" href="LocalComp.Env.html#l:29"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">length_rev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_Some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lvl_get_In" class="idref" href="#lvl_get_In"><span class="id" title="lemma">lvl_get_In</span></a> [<a id="A:32" class="idref" href="#A:32"><span class="id" title="binder">A</span></a>] <a id="l:33" class="idref" href="#l:33"><span class="id" title="binder">l</span></a> <a id="n:34" class="idref" href="#n:34"><span class="id" title="binder">n</span></a> <a id="a:35" class="idref" href="#a:35"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<span class="id" title="var">A</span> := <a class="idref" href="LocalComp.Env.html#A:32"><span class="id" title="variable">A</span></a>) <a class="idref" href="LocalComp.Env.html#l:33"><span class="id" title="variable">l</span></a> <a class="idref" href="LocalComp.Env.html#n:34"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#a:35"><span class="id" title="variable">a</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="definition">In</span> <a class="idref" href="LocalComp.Env.html#a:35"><span class="id" title="variable">a</span></a> <a class="idref" href="LocalComp.Env.html#l:33"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="abbreviation">In_rev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_In</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lvl_get_map" class="idref" href="#lvl_get_map"><span class="id" title="lemma">lvl_get_map</span></a> [<a id="A:36" class="idref" href="#A:36"><span class="id" title="binder">A</span></a> <a id="B:37" class="idref" href="#B:37"><span class="id" title="binder">B</span></a>] (<a id="f:38" class="idref" href="#f:38"><span class="id" title="binder">f</span></a> : <a class="idref" href="LocalComp.Env.html#A:36"><span class="id" title="variable">A</span></a> <span class="id" title="notation">→</span> <a class="idref" href="LocalComp.Env.html#B:37"><span class="id" title="variable">B</span></a>) <a id="l:39" class="idref" href="#l:39"><span class="id" title="binder">l</span></a> <a id="x:40" class="idref" href="#x:40"><span class="id" title="binder">x</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="LocalComp.Env.html#f:38"><span class="id" title="variable">f</span></a> <a class="idref" href="LocalComp.Env.html#l:39"><span class="id" title="variable">l</span></a>) <a class="idref" href="LocalComp.Env.html#x:40"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="LocalComp.Env.html#f:38"><span class="id" title="variable">f</span></a> (<a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a> <a class="idref" href="LocalComp.Env.html#l:39"><span class="id" title="variable">l</span></a> <a class="idref" href="LocalComp.Env.html#x:40"><span class="id" title="variable">x</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LocalComp.Env.html#lvl_get"><span class="id" title="definition">lvl_get</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">map_rev</span>, <span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ictx_get_map" class="idref" href="#ictx_get_map"><span class="id" title="lemma">ictx_get_map</span></a> <a id="9c037d576aa07b88b830372dfc55bc00" class="idref" href="#9c037d576aa07b88b830372dfc55bc00"><span class="id" title="binder">Ξ</span></a> <a id="x:42" class="idref" href="#x:42"><span class="id" title="binder">x</span></a> <a id="f:43" class="idref" href="#f:43"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#ictx_get"><span class="id" title="abbreviation">ictx_get</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="LocalComp.Env.html#f:43"><span class="id" title="variable">f</span></a> <a class="idref" href="LocalComp.Env.html#9c037d576aa07b88b830372dfc55bc00"><span class="id" title="variable">Ξ</span></a>) <a class="idref" href="LocalComp.Env.html#x:42"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="LocalComp.Env.html#f:43"><span class="id" title="variable">f</span></a> (<a class="idref" href="LocalComp.Env.html#ictx_get"><span class="id" title="abbreviation">ictx_get</span></a> <a class="idref" href="LocalComp.Env.html#9c037d576aa07b88b830372dfc55bc00"><span class="id" title="variable">Ξ</span></a> <a class="idref" href="LocalComp.Env.html#x:42"><span class="id" title="variable">x</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="LocalComp.Env.html#lvl_get_map"><span class="id" title="lemma">lvl_get_map</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Global declaration 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <a id="gdecl" class="idref" href="#gdecl"><span class="id" title="definition, inductive"><span id="gdecl_rect" class="id"><span id="gdecl_ind" class="id"><span id="gdecl_rec" class="id"><span id="gdecl_sind" class="id">gdecl</span></span></span></span></span></a> :=<br/>
| <a id="Def" class="idref" href="#Def"><span class="id" title="constructor">Def</span></a> (<a id="7c0e9ca7a409e57ed03a8eafeab84ec2" class="idref" href="#7c0e9ca7a409e57ed03a8eafeab84ec2"><span class="id" title="binder">Ξ</span></a> : <a class="idref" href="LocalComp.Env.html#ictx"><span class="id" title="definition">ictx</span></a>) (<a id="A:47" class="idref" href="#A:47"><span class="id" title="binder">A</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>) (<a id="t:48" class="idref" href="#t:48"><span class="id" title="binder">t</span></a> : <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="gctx" class="idref" href="#gctx"><span class="id" title="definition">gctx</span></a> : <span class="id" title="keyword">Type</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="LocalComp.BasicAST.html#gref"><span class="id" title="definition">gref</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="LocalComp.Env.html#gdecl"><span class="id" title="inductive">gdecl</span></a>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="gctx_get" class="idref" href="#gctx_get"><span class="id" title="definition">gctx_get</span></a> (<a id="bee78f44e79dd1f39e7aa3afe03ef2db" class="idref" href="#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="LocalComp.Env.html#gctx"><span class="id" title="definition">gctx</span></a>) (<a id="c:50" class="idref" href="#c:50"><span class="id" title="binder">c</span></a> : <a class="idref" href="LocalComp.BasicAST.html#gref"><span class="id" title="definition">gref</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="LocalComp.Env.html#gdecl"><span class="id" title="inductive">gdecl</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="LocalComp.Env.html#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="variable">Σ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">[]</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">Σ</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="LocalComp.Env.html#c:50"><span class="id" title="variable">c</span></a> <span class="id" title="notation">=?</span> <span class="id" title="var">k</span>)%<span class="id" title="var">string</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">d</span> <span class="id" title="keyword">else</span> <a class="idref" href="LocalComp.Env.html#gctx_get:51"><span class="id" title="definition">gctx_get</span></a> <a class="idref" href="LocalComp.Env.html#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="variable">Σ</span></a> <a class="idref" href="LocalComp.Env.html#c:50"><span class="id" title="variable">c</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="LocalComp.Env.html#gctx_get"><span class="id" title="definition">gctx_get</span></a> <a class="idref" href="LocalComp.Env.html#gctx_get"><span class="id" title="definition">:</span></a> <a class="idref" href="LocalComp.Env.html#gctx_get"><span class="id" title="definition">gctx</span></a> <a class="idref" href="LocalComp.Env.html#gctx_get"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="LocalComp.Env.html#gctx_get"><span class="id" title="definition">Funclass</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extends" class="idref" href="#extends"><span class="id" title="definition">extends</span></a> (<a id="20d7c0ecc86fe88fa924e57d0c585b54" class="idref" href="#20d7c0ecc86fe88fa924e57d0c585b54"><span class="id" title="binder">Σ</span></a> <a id="ab34479d59c2a92a6beaa06081a88af4" class="idref" href="#ab34479d59c2a92a6beaa06081a88af4"><span class="id" title="binder">Σ'</span></a> : <a class="idref" href="LocalComp.Env.html#gctx"><span class="id" title="definition">gctx</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">∀</span> <a id="r:55" class="idref" href="#r:55"><span class="id" title="binder">r</span></a> <a id="d:56" class="idref" href="#d:56"><span class="id" title="binder">d</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#20d7c0ecc86fe88fa924e57d0c585b54"><span class="id" title="variable">Σ</span></a> <a class="idref" href="LocalComp.Env.html#r:55"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#d:56"><span class="id" title="variable">d</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LocalComp.Env.html#ab34479d59c2a92a6beaa06081a88af4"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="LocalComp.Env.html#r:55"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="LocalComp.Env.html#d:56"><span class="id" title="variable">d</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="807cf07fc9b6e174a5f6d1ef141e1432" class="idref" href="#807cf07fc9b6e174a5f6d1ef141e1432"><span class="id" title="notation">&quot;</span></a>a ⊑ b" := (<a class="idref" href="LocalComp.Env.html#extends"><span class="id" title="definition">extends</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="var">b</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab5"></a><h2 class="section">Notations</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a id="1448427eac1a65e78664fcb1ce2eafe2" class="idref" href="#1448427eac1a65e78664fcb1ce2eafe2"><span class="id" title="notation">&quot;</span></a>'∙'" :=<br/>
&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="b66601545ff7e22c5dcb7c86aa0cca21" class="idref" href="#b66601545ff7e22c5dcb7c86aa0cca21"><span class="id" title="notation">&quot;</span></a>Γ ,, d" :=<br/>
&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> <span class="id" title="var">d</span> <span class="id" title="var">Γ</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">d</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="9c82c702508313fd669cee3f1f4704ce" class="idref" href="#9c82c702508313fd669cee3f1f4704ce"><span class="id" title="notation">&quot;</span></a>Γ ,,, Δ" :=<br/>
&nbsp;&nbsp;(@<span class="id" title="abbreviation">List.app</span> <a class="idref" href="LocalComp.autosubst.AST.html#Core.term"><span class="id" title="inductive">term</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Γ</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 25, <span class="id" title="var">Δ</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
</div>
</div>

<div id="footer">
<hr/><a href="indexpage.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>